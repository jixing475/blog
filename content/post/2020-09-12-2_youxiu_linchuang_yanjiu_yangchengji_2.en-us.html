---
title: "优秀临床研究养成记(2): 多元回归分析"
author: ZERO
date: '2020-09-12'
slug: 2_youxiu_linchuang_yanjiu_yangchengji_2.en-us
categories:
  - data science
tags:
  - Clinical
keywords:
  - tech
thumbnailImage: https://tva1.sinaimg.cn/large/007S8ZIlgy1gilm7sa11sj310u0gzq7l.jpg
thumbnailImagePosition: left
output:
  blogdown::html_page:
    toc: true
    toc_depth: 1
    number_sections: true
    fig_width: 6
bibliography: "./../../references.bib"
---



<!--more-->
<div id="背景介绍" class="section level2">
<h2><span class="header-section-number">0.1</span> 背景介绍</h2>
<p>线性回归, Logistic回归和Cox比例风险回归模型是使用非常广泛的多元回归分析方法.在《智能统计》中介绍了有关计算原理,相关软件的应用以及这三者的计算结果解释的详细信息. 但是,我们却很少谈论<strong>自变量筛选方法</strong>, 这些方法在数据分析过程和撰写文章期间引起了混乱. 本文将重点介绍这一部分.</p>
<p>研究人员在自变量筛选期间遇到问题时将会向统计学家求助, 统计学家一般会建议在软件中应用自动筛选,例如IBM SPSS中的Logistic回归和Cox回归, 一般有以下7种变量筛选方法:</p>
<ol style="list-style-type: decimal">
<li>条件参数估计似然比检验(Forward: Condition)；</li>
<li>局部最大似然估计的似然比检验(Forward LR)；</li>
<li>Wald卡方检验(Forward: Wald)；</li>
<li>条件参数估计似然比检验(Backward: Condition)；</li>
<li>最大局部似然估计的似然比检验(Backward: LR)；</li>
<li>Wald卡方检验(Backward: Wald)；</li>
<li>默认方法, 包含所有变量(all variable included, default method).</li>
</ol>
<p>实际上在临床试验报告中, 许多作者都采用了这些筛选方法中的一种. 接下来我们要谈论的是: 首先对每个变量进行单变量回归分析. P值小于0.1的那些值将包含在回归公式中(此处P值可以小于0.05或0.2, 但在通常情况下, P值的范围可以在0.05-0.2之间). 这种方法很有争议. 对于研究人员, 如何选择更好的方法实际上是一项可选测试. 老实说, 没有标准答案. 但我们还有一些规则可以遵循, 以便更好地进行变量筛选:</p>
<ol style="list-style-type: decimal">
<li><p>当样本量足够大的时候, 统计检验能力足够, 可以从前面提到的六种筛选方法中任选择一种. 这里介绍一种可以帮助您快速评估测试效率的方法:每个变量对应20个样本(事件). 例如, 在Cox回归检验中, 如果我们包括10个与预后(Y)相关的变量(X), 则至少应招募200名患者以评估终点事件, 例如死亡(应包括200名死亡患者, 而不是总共200名患者). 因为那些没有终点事件的样本不会被视为检验有效样本.</p></li>
<li><p>当样本量不符合第一条件或由于其他一些原因统计能力不足时, 应在大多数临床报告中采用广泛使用的筛查方法. 可以首先对每个变量进行单变量回归分析; P值小于0.2的那些将包括在回归公式中. 正如之前提到的, 这种方法颇有争议.</p></li>
<li><p>在实践中第二种筛选方法也将面临挑战. 有时, 我们发现一些与预后显着相关的变量可能因在已经建立的筛查方法中的不显著而被排除在外. 例如, 在前列腺癌预后研究中, 作者发现格里森评分(Gleason score)与筛查模型中的预后没有显着相关性, 而格里森评分(Gleason score)是先前研究中确诊前列腺癌预后的因素. 这个时候我们应该怎么做？<strong>一般处理是, 尽管这些变量在我们的分析中, 统计学筛查显示其不显著相关, 但出于领域专业观点和临床原因, 还是应在分析中纳入这些变量. </strong></p></li>
</ol>
<p>综上所述, 作者建议采用第三种变量筛选方法. 应<strong>同时考虑单因素分析结果和临床原因(之前研究已经详细阐明显著相关的变量), 样本量和统计功效</strong>.</p>
</div>
<div id="争议和共识" class="section level2">
<h2><span class="header-section-number">0.2</span> 争议和共识</h2>
<p>关于变量筛选的争论已经进行了很长一段时间. 统计学家以非常专业的眼光来看待它, 但是临床医生并不总是遵循这些建议. 在临床研究中, 很难区分实际问题的对与错, 例如小样本; 知识有限, 无法确定结果的确切因素. 但是, 我们在筛选过程中仍有一些参考标准. 在顶级杂志上发表的有关高质量临床研究的综述中, 在进行变量筛查时将考虑以下5种情况:</p>
<ol style="list-style-type: decimal">
<li><p>临床角度. 这是变量筛选最先应该考虑的. 如果临床研究仅仅是统计分析, 那么它可能毫无意义. 基于专业观点, 回归模型中应包括与结果显着相关的公认变量, 例如前列腺癌的格里森评分. 其他统计不显著的变量则不需要考虑.</p></li>
<li><p>基于单变量分析的筛选. 单变量分析中具有显着P值的变量应包括在多元回归中. 如果P &lt;0.1, 我们认为它是“显着的”. 有时P &lt;0.2或P &lt;0.05被认为是“显着的”. P值可以根据样本大小而变化. 大样本量将具有较小的P值. 小样本量将具有相对较大的P值. 在已经发表的文章中, 甚至在顶级杂志中, 这种筛选方法都是相当普遍的. 虽然这种方法有受到统计学家的质疑, 由于现在没有更精确, 更科学的选择, 它仍然一直被使用. 甚至统计学家也找不到更好的替代方法. 在我们找到更好的替代方案之前, 拥有一个可行的方案总比束手无策强.</p></li>
<li><p>将基于混杂因子“Z”对检验因素或暴露因素“X”的影响来选择变量. 具体来说, 当“Z”改变时, 我们将观察“X”是否会影响因变量“Y”. 首先运行仅包含“X”的基本模型, 记录回归系数<code>β1</code>, 然后将“Z”添加到模型中以查看β1发生了多少变化. 通常认为<strong>β1的变化超过10％</strong>, 需要对该混淆因素变量进行矫正, 否则就不需要. 该方法与第二种方法不同, 因为它量化了混杂因素产生的影响. 但这种方法也是不完美的, 因为“Z”和“X”对“Y”的影响可能会受到其他混杂因素的影响. 我们认为, 这是一种可接受的变量筛选方法, 特别是对于具有非常具体目标的分析. 我们可以确定“X”独立“Z”对于“Y”的影响, 我们可以矫正这些混杂因素.</p></li>
<li><p>选择最终将包含在模型中的正确变量数量非常重要. 这是一个很现实的问题. 如果样本量足够大并且统计性能足够, 我们可以使用统计软件提供的变量筛选方法来自动过滤变量, 并可以过滤出适合统计中独立影响结果的变量. “理想很丰满, 但现实很骨感”. 有时我们想考虑很多变量, 但样本量却很小. 我们必须在统计效率和变量筛选之间做出妥协, 折中可以带来更好的结果.</p></li>
<li><p>上面列出了四种常用的变量筛选方法. 还有许多其他变量筛选方法, 例如基于模型参数的方法:确定系数R<sup>2</sup>, AIC, likelihood logarithm, C-Statistics等. 这么多变量筛选方法可以证明 实践中没有一种方法是适合所有分析的. 本文旨在帮助大家找到正确的筛选方法, 而不是评选最佳方法或最差方法. 根据实际情况选择最适合的方法是本文的目的.</p></li>
</ol>
</div>
<div id="收集整理不同类型变量的方法" class="section level2">
<h2><span class="header-section-number">0.3</span> 收集整理不同类型变量的方法</h2>
<p><strong>连续变量</strong>. 对于连续变量, 有一个很好的标准可供参考. 如果变量和结果之间的关系是线性的, 则可以在回归公式中纳入此连续变量. 如果不是, 则可以将其转换为二分变量或有序分类变量, 然后将其放入回归公式中. 进行此转换是因为变量可能与结果不是线性的, 而多远回归分析的前提假设是自变量和因变量之间是线性的关系.</p>
<p><strong>连续变量转换总结</strong>. 当回归模型中包含连续变量时, 该模型中应尽可能包含原始变量, 并同时考虑实际需要根据一些规则来转换变量. 常见规则有, 二分类分组, 等分分组, 等距分组和临床临界值分组(Two-category grouping, aliquot grouping, equidistant grouping, and clinical cut-off value grouping), 这些转换能提供更好的临床解释. 通过最佳截断点分析, 将连续变量转换为分类变量, 并将其作为哑变量纳入到回归模型中.</p>
<p>在回归模型中, 连续变量可以以不同的方式出现. 参考以下具体示例, 无论采用哪种方式呈现, 总的原则是这种转换更适合临床的解释和理解.</p>
<p><strong>正态转换</strong>. 对于正态分布的连续变量不需要转换. 但是, 当我们遇到不符合正态分布的数据时, 变量可以基于某些函数进行转换, 以满足回归模型的前提假设. 原始数据可以根据自己的特性通过不同的函数进行标准化, 例如 Square Root method, LnX method, Log10X method 和 (1/X)等. 如果已对原始数据进行了归一化, 不要在回归模型中解释原始变量, 而是解释正态转换的变量, 或者可以利用转换函数估算出原始自变量对原始因变量的影响.</p>
<p>例如, 作者在JACC(21), 2016年发表的文章中进行了正态性检验. 原始表达式如下:连续变量的正态性通过Kolmogorov-Smirnov检验评估. 正态性测试方法包括使用数据分布的参数:偏度值和峰度值(the skewness value and the kurtosis value)和数据分布图:直方图, P-P图, Q-Q图(histogram, P-P diagram, Q-Q diagram). 或将使用一些非参数测试方法(Shapiro-Wilk检验, Kolmogorov-Smirnov检验)来帮助我们评估数据的正态性.</p>
<p>在他们的研究中, 肌钙蛋白I, NT-proBNP或corin等变量均是非正态分布. 因此, 作者按Median( IQR)描述了这些收集对象的基线特征. 例如, 肌钙蛋白I的中位数为4.5(1.8-12.6)ng/mL. 然后进行多元线性回归分析. 原始表达式如下:应用多元线性回归分析确定影响corin水平的因素. 通过Log10转化将肌钙蛋白I, NT-proBNP和corin的水平标准化. 肌钙蛋白I, NT-proBNP和corin等变量已通过Log10函数进行了归一化处理, 此后已包含在多变量线性回归中. 然后, 作者进行了Cox回归. 尽管对Cox回归没有特殊要求, 但仍然使用Log10函数对肌钙蛋白I, NT-proBNP和corin进行了标准化.</p>
<p>📌 如果将连续变量以其原始形式直接引入模型中, 则回归参数的解释为因每单位自变量增加而引起的因变量变化. 但是, 有时此变化的效果可能很弱. 因此, 我们可以将等距分组中的固定间隔将连续独立变量转换为分类变量, 然后将其引入模型进行分析. 该分组有助于更好地理解和应用于患者. 例如, 我们包括年龄在31至80岁之间的患者. 根据10岁年龄段, 我们可以将其分为10-40、41-50、51-60、61-70、71-80组. 然后, 将五个已经设置的哑变量纳入到模型中进行分析.</p>
<p>📌 但是, 如果变量范围很大, 那么根据我们前面提到的方法进行分组将导致太多的组和太多的哑变量, 这将导致在分析期间将是非常冗余, 临床解释也非常困难. 在面对一些范围较小且无法再次分组的数据, 也无法将其转换为分类变量时, 我们该怎么办？</p>
<p>在这里, 我们参考在JACC, 2016年发表的文章(19). 我们在模型中发现, 作者使用了很多“per”, 例如per 5％变化, per 0.1 U, per 100 mL/min等. 这是每次变化以固定增量递增的连续变量的转换以“per + interval + unit”为单位. 我们将在本文中说明两个示例.</p>
<ul>
<li><p>氧气吸收效率斜率的平均值为1655U, 5-95％的人口将从846变为2800U. 这确实是一个很大的范围. 如果将原始数据放入公式中, <strong>per 1U的变化将导致HR每周变化一次, 这在临床实践中是没有意义的</strong>. <strong>如果将其转换为分类变量, 则会出现许多组</strong>. 因此, 作者将per 100 U的变化包括到模型中, 发现当每100 U的氧气吸收效率斜率增加时, 死亡风险将降低9％(HR= 0.91, 95％CI:0.89–0.93).</p></li>
<li><p>另一个例子是可变的峰值RER. 中位数为1.08 U, 并且人口的5–95％将从0.91–1.27 U更改. 确实很小. 如果将原始数据放到公式中, <strong>每1 U的变化将导致HR的很大变化</strong>. 在临床实践中, 变化1 U的患者非常少见, 并且这种结果的实用性有限. <strong>对于小范围的连续变量分类转换也非常困难</strong>. 因此, 作者将per 0.1U的变化包括到模型中, 发现当峰值RER per 0.1 U增加时, 死亡风险将降低6％(HR= 0.94, 95％CI:0.86-1.04). 但是, 这在统计学上并不显着.</p></li>
</ul>
<p>🛠 <strong>那么, 我们如何进行这种转换</strong>？如果要将因子从 <code>each1 unit</code> 更改为 <code>100 unit</code>, 它将扩大100倍. 我们只需要<strong>将原始变量除以100</strong>, 然后将其包含到模型中即可. 同样, 如果要将因子从1 unit更改为0.1 unit, 则更改将减少10倍. 只需要将<strong>原始变量乘以10</strong>并将其包含在回归模型中即可.</p>
<p>📌 在临床研究中 per SD转换，我们得用另一种转换方法： per SD增加时的自变量变化。让我们看看2016年在JACC上发表的一篇文章（20）。根据SD的增加，年龄和收缩压都包括在模型中。随着 per SD年龄的增加，动脉粥样硬化性心脏病（ASCVD）的风险增加70％（HR= 1.70，95％CI：1.32-2.19）。每次SD收缩压（SBP）升高，ASCVD风险增加25％（HR= 1.25，95％CI：1.05-1.49）。在这里，作者以 per SD增加的形式将连续变量放入模型中。假设变量符合正态分布，则Mean±1 SD区间内的面积为68.27％，Mean±1.96，SD区间内的面积为95％。如果Mean±2.58，则SD间隔内的面积为99％。我们可以说，如果数据范围在4 SD之内，则将覆盖大约95％的样本。因此，对于新的变量，尤其是那些在临床上解释不清楚的变量，我们可以将 per SD放入模型中。它可以指导患者根据他或她的实际测量结果看他或她在人口分布水平的几个标准偏差范围内，然后评估相应的风险将改变多少。</p>
<p>🛠 进行这种转换非常简单. 我们可以使用以下两种方式:</p>
<ol style="list-style-type: decimal">
<li><p>在构建回归模型之前, 应先<strong>对原始连续变量进行归一化</strong>, 然后将归一化的自变量引入回归模型. 获得的回归系数是因变量对每个因数SD的影响. (注意:此处<strong>仅对自变量进行了标准化</strong>).</p></li>
<li><p>如果未对原始变量进行归一化, 则可以将原始变量直接纳入模型中, 并获得非标准化系数(Unstandardized Coefficients), 然后通过将自变量的标准偏差乘以自变量的标准偏差来计算, 称为标准化系数(Standardized Coefficients).(and then the standard deviation of the independent variables is calculated by multiplying the standard deviation of the independent variables, which is also called Standardized Coefficients. ) 这是因变量对自变量per SD增加的影响.</p></li>
</ol>
<div id="rank-variable" class="section level3">
<h3><span class="header-section-number">0.3.1</span> Rank variable</h3>
<p>Rank variable是非常常用的做法. 它是一种有序的多类别变量. 通常, 多个数据可以存在于同一变量中, 并且这些数据彼此之间排名相关. 例如, 高血压等级(0=正常, 1=高正常, 2= 1级, 3= 2级, 4= 3级), 尿蛋白水平(0=-, 1=±, 2=+, 3=++, 4=+++, 5=++++), 药物的效果(无效, 改善, 治愈), 它们都是等级变量. 它与无序多类别变量不同. 有序多类别变量呈现单调递增或递减. 如果在Logistic回归模型中将有序的多类别变量用作Logistic回归模型, 则不建议将这些变量直接作为连续变量引入, 除非每单位更改可能导致结果中相同的风险比更改. 但是, 大多数情况下, 理想情况下不会改变. 因此, 我们建议将有序的多类别变量视为哑变量, 可以将每个级别与另一个级别进行比较. 当结果 与线性无关, 应使用<code>optimal scale regression</code>来探讨高影响拐点.</p>
</div>
<div id="non-ordered-multi-categorical-variable" class="section level3">
<h3><span class="header-section-number">0.3.2</span> Non-ordered &amp; multi-categorical variable</h3>
<p>无序和多类别变量是非常常见的变量样式. 通常, 在多类别变量中有多个可能的值, 而彼此之间没有层次关系. 例如种族(1=白色, 2=黑色, 3=黄色, 4=其他), 药物给药方法(1=口服, 2=皮下注射, 3=静脉注射, 4=其他), 它们都是无序的多类别变量. 当非有序多类别变量位于Logistic或Cox回归模型中时, 我们需要事先设置哑变量, 然后再将其纳入模型. 后面会介绍哑变量设置方法.</p>
<p>🛠 哑变量设置方法:</p>
<ol style="list-style-type: decimal">
<li>Indicator:此方法用于指定分类变量的参考级别.</li>
<li>Simple:此方法可以计算分类变量的每个级别与参考级别的比率.</li>
<li>Difference:此方法可以将类别变量与所有级的平均值进行比较. 这与赫尔默特完全相反. 因此, 它也被称为反向赫尔默特. 例如, 可以将级别2的平均值与级别1的平均值进行比较. 级别3的平均值可以分别与级别1和级别2的平均值进行比较, 依此类推. 如果系数在一定水平上变小并且在统计上不显着, 则分类变量对风险比的影响达到其平稳状态. 此选项通常用于有序分类变量, 例如吸烟剂量. 假设研究人员将它们分为独立的无序多类别变量, 那将毫无意义.</li>
<li>Difference:我们将类别变量的水平与以下水平的平均值进行比较. 如果某个级别的系数增加并且具有统计意义, 则表明类别变量对该级别的风险率有影响. 它也可以用于有序分类变量.</li>
<li>Repeated:将分类变量的级别与与其相邻的级别进行比较, 但第一个级别除外, 在第一个级别中, “上一个级别”用作参考级别.</li>
</ol>
</div>
</div>
<div id="小结" class="section level2">
<h2><span class="header-section-number">0.4</span> 小结</h2>
<p>我们已经总结了<strong>筛选方法和变量转换方法</strong>. 绝对完美的方法在现实世界中是不存在的. 但是我们仍然可以选择相对正确的方法. 与胡乱选择一种方法相比, 我们需要更多的科学解决方案. 有一种可供参考的方法是: 可以根据以前发布的临床试验<strong>构建多个模型</strong>(模式1, 模型2, 模型3…), 尤其是那些具有较高影响评分的临床试验, 并获得每个模型的客观结果. 实际上是敏感性分析. 将基于不同的变量构建不同的模型. <strong>某些变量可能与真实世界密切相关, 即使在不同模型中, 它们也将导致相对稳定的结果</strong>. 这也是达到分析目的的一种方法. 我们不会在这里对各个方法好坏进行评判. 只是想从结果中找出最稳定的结果因素.</p>
<p>在构建预测模型时, 除了在所有这些可能变量中筛选之外, 我们也应该考虑其他具体变量. 例如, 针对恶性肿瘤的TNM分期被广泛用于其在临床实践中的简便应用, 而不是其在预后方面的预测价值. 实际上, TNM分级预测值就这样. 另外我们不得不谈论的一个问题是:我们如何<strong>评估模型的准确性和简单性</strong>？更多的变量可能会导致对模型的更准确的预测, 而对临床应用则更加困难. 这时候做出相应的妥协是必须的.</p>
</div>
